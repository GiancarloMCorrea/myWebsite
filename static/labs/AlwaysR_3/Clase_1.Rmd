---
title: "AlwaysR, Módulo III: Estadística en R"
author: "Giancarlo M. Correa"
institute: "Cousteau Consultant Group"
date: "17/07/2021"
output:
  xaringan::moon_reader:
    seal: false
    lib_dir: libs
    nature:
      highlightStyle: github
      highlightLines: true
      countIncrementalSlides: false
---

class: inverse, center, middle

# AlwaysR, Módulo III: Estadística en R

```{css, echo=FALSE}
.my-one-page-font {
  font-size: 25px;
}
.scroll-output {
  overflow-y: scroll;
}
```

## Clase 1: Introducción. Estadística descriptiva. Distribuciones de probabilidad. 

### Dr. Giancarlo M. Correa

<img src="LOGO05.png" width="350px"/>

---

```{r setup1, include=FALSE}
options(htmltools.dir.version = FALSE)
```

class: inverse, center, middle

# Introducción

```{r xaringan-logo, echo=FALSE}
xaringanExtra::use_logo(
  image_url = "LOGO06.png", position = xaringanExtra::css_position(bottom = '-3em', left = 0),
  link_url = 'https://cousteau-group.com/', width = "70px"
)
```

---

# Presentaciones

<br>

<br>

.my-one-page-font[

* Mi nombre es:

* Mi nacionalidad es y/o resido en:

* Me dedico a:

* Mi área de estudio es:

]

---

# Silabo

Revisar silabo en [Cousteau Consultant Group](https://cousteau-group.com/cursos/alwasyr_modulo_3/).

También puede ser encontrado en el Google Drive.

---

# Metodología

* ***Preguntas***: En cualquier momento. Dejar preguntas en el chat o activar micrófono.

--

* ***Material***: Presentaciones, códigos y videos en Google Drive. También puede ser encontrado en mi [sitio web](https://giancarlomcorrea.netlify.app/es/courses/alwaysr3/).

--

* ***Certificado***: De asistencia ó aprobación (completar todos los quizzes al término de la semana).

--

* ***Horas de oficina***: Por definir

--

* ***Contacto***: Escribir a [*cursos@cousteau-group.com*](mailto:cursos@cousteau-group.com) ó [*gcorrea@uw.edu*](mailto:gcorrea@uw.edu)


---

class: inverse, center, middle

# Estadística descriptiva

---

# Variable

Es un atributo que describe un individuo, lugar, o cosa. Este atributo puede variar entre individuos. Ejemplo: altura total, temperatura, edad, estadio sexual.

--

* **Cuantitativa**: Refleja magnitud. Representa una medida y es numérica.

> - *Discreta*: Valores que toman son contables y tienen un número finito de posibilidades.

> - *Continua*: Valores no son contables y tiene un infinito número de posibilidades.

--

* **Cualitativa**: No son numericas, valores son categorías.

> - *Nominal*: No existe un orden para los niveles.

> - *Ordinal*: Existe un orden para los niveles. 

---

# Muestra

.scroll-output[

Tomamos datos de la altura ( $m$ ) de 20 árboles ( $n = 20$ ) de un bosque que se quiere investigar y lo guardamos en un vector llamado `altura`:

```{r, echo = FALSE}
set.seed(123)
altura = round(x = rnorm(n = 20, mean = 100, sd = 10), digits = 2)
```

```{r}
print(altura)
```

--

También tomamos datos del número de raíces principales de cada árbol: 

```{r, echo = FALSE}
set.seed(123)
raices = rpois(n = 20, lambda = 2)
```

```{r}
print(raices)
```

]
---

# Media

Calculada como:

$$\bar{x}={\frac {1}{n}}\sum _{i=1}^{n}x_{i}={\frac {x_{1}+x_{2}+\cdots +x_{n}}{n}}$$

--

En *R* podemos usar:

```{r}
mean(x = altura)
```

Unidades: $m$

--

Algo **muy** imporante es ver la ayuda de una función cuando no sepamos como utilizarla, por ejemplo: `?mean` 

---

# Mediana

Valor encontrado en el medio de todo el conjunto de valores.

--

En *R* podemos usar:

```{r}
median(x = altura)
```

Unidades: $m$

---

# Moda

El valor más frecuente en los datos.

--

*R* no tiene una función por defecto para calcular la moda, pero podemos hacer una:

```{r}
getmode <- function(x) {
   uniqv <- unique(x)
   uniqv[which.max(tabulate(match(x, uniqv)))]
}
```

--

Luego la usamos:

```{r}
getmode(x = raices)
```

--

O utilizar:

```{r eval = FALSE}
DescTools::Mode(x = altura)
```

---

# Varianza

Calculada como (para la muestra):

$$s^2 = \frac{\sum_{i=1}^{n}(x_i - \bar{x})^2} {n-1}$$

--

En *R* podemos usar:

```{r}
var(x = altura)
```

Si se desea calcular la varianza poblacional, se multiplica por $(n-1)/n$.

Unidades: $m^2$.

---

# Desviación estándar

Calculada como (para la muestra):

$$s = \sqrt{s^2}$$

--

En *R* podemos usar:

```{r}
sd(x = altura)
```

Unidades: $m$.

--

Recordemos que `sd(x = altura)^2` es igual a `var(x = altura)`.

---

# Coeficiente de variación

Calculada como:

$$CV = s/\bar{x}$$

--

En *R* podemos usar:

```{r}
sd(altura)/mean(altura)
```


---

# Mínimo y máximo

Simplemente se calcula es mínimo y máximo valor observado en la muestra.

--

En *R* podemos usar (mínimo):

```{r}
min(x = altura)
```

Unidades: $m$.

--

En *R* podemos usar (máximo):

```{r}
max(x = altura)
```

Unidades: $m$.


---

# Rango

Simplemente se calcula es mínimo y máximo valor observado en la muestra.

--

En *R* podemos usar:

```{r}
range(x = altura)
```

Unidades: $m$.

---

# Cuartiles y percentiles

* *Cuartiles*: Valores que dividen a los datos en cuatro partes. E.g.: primer (25%), segundo (50%) y tercer (75%) cuartil.

* *Percentil*: Valores que dividen a los datos en cien partes. E.g.: Percentil 1, 2, etc.

--

En *R* podemos usar (para cuartiles y percentiles) (Unidades: $m$):

```{r}
quantile(x = altura, probs = 0.25)
```

Aquí, `probs = 0.25` especifica el primer cuartil o el percentil 25. 

--

```{r}
quantile(x = altura, probs = 0.6)
```

Aquí, `probs = 0.6` especifica el percentil 60.

---

# Rango interquartil

Diferencia entre el tercer y primer cuartil.

--

En *R* podemos usar:

```{r}
IQR(x = altura)
```



---

# Datos faltantes

En el caso que tengamos datos faltantes, la variable puede ser:

```{r, echo = FALSE}
altura_save = altura
altura[c(3,7)] = NA
print(altura)
```

--

Si usamos las funciones anteriores tal cual, vemos que:

```{r}
mean(altura)
```

--

En estos casos, tenemos que agregar el argumento `na.rm = TRUE` a las funciones exploradas:

```{r}
mean(altura, na.rm = TRUE)
```

```{r, echo = FALSE}
altura = altura_save
```

---

# Resumen de un conjunto de datos

Podemos obtener estadísticos descriptivos rápidamente de todas las variables de una base de datos, por ejemplo:

```{r}
summary(airquality)
```

---

# Figuras

```{r, out.width=500, fig.align="center"}
boxplot(x = altura, ylab = 'Altura (m)')
```

---

# Figuras

```{r, out.width=400, fig.align="center"}
hist(x = altura, xlab = 'Altura (m)', ylab = 'Frecuencia', main = '')
```

---

# Figuras

```{r, out.width=400, fig.align="center"}
hist(x = altura, xlab = 'Altura (m)', ylab = 'Frecuencia', main = '')
abline(v = mean(altura), col = 'red', lty = 2)
```

---

# Figuras

```{r, out.width=400, fig.align="center"}
hist(x = altura, xlab = 'Altura (m)', ylab = 'Frecuencia', main = '')
abline(v = mean(altura), col = 'red', lty = 2)
abline(v = median(altura), col = 'blue', lty = 2)
```

---

# Figuras

```{r, out.width=400, fig.align="center"}
plot(density(altura))
```

---

# Figuras

Los histogramas y boxplots nos dan información de la dispersión de los datos:

```{r echo = FALSE, out.width=400, fig.align="center"}
knitr::include_graphics("images/IQR_image.jpg")
```


---

class: inverse, center, middle

# Distribuciones de probabilidad

---

# Distribución normal

Variable continua. Función de densidad:

$$f(x) = \frac{1}{{\sigma \sqrt{2\pi}}} e^{{{ -(x - \mu)^2/2\sigma^2 }}}\hspace{1cm}-\infty <x< \infty$$

donde $\mu$ (media) y $\sigma$ (desviación estándar) son los parámetros de la función. Representada como: $N(\mu, \sigma^2)$.

--

Media $E(X) = \mu$

Varianza $Var(X) = \sigma^2$


---

# Distribución normal

Podemos generar 100 números aleatorios con distribución normal, con determinada media y desviación estándar:

```{r, eval = FALSE}
rnorm(n = 100, mean = 20, sd = 3)
```

```{r, echo = FALSE, out.width=400, fig.align="center"}
vec1 = rnorm(n = 100, mean = 20, sd = 3)
hist(vec1, ylab = 'Frecuencia', main = '', xlab = '')
```

---

# Distribución normal

Distribución normal estándar ( $\mu = 0$ y $\sigma^2=1$ ):

```{r, echo = FALSE, out.width=400, fig.align="center"}
x = seq(-5, 5, by = 0.1)
hx = dnorm(x) 
plot(x, hx, type="l", xlab="Valores de variable",
     ylab = "Densidad", main="")
```

---

# Distribución normal

Probabilidad acumulada:

```{r, echo = FALSE, out.width=300, fig.align="center"}
x = seq(-5, 5, by = 0.1)
hx = dnorm(x) 
lb = -5 
ub = -2
i = x >= lb & x <= ub
plot(x, hx, type="l", xlab="Valores de variable",
     ylab = "Densidad", main="")
lines(x, hx)
polygon(c(lb,x[i],ub), c(0,hx[i],0), col="red") 
```

--

Podemos usar la función:

```{r}
pnorm(q = -2, mean = 0, sd = 1)
```

---

# Distribución normal

Probabilidad a un valor de variable dado:

```{r, echo = FALSE, out.width=300, fig.align="center"}
x = seq(-5, 5, by = 0.1)
hx = dnorm(x) 
plot(x, hx, type="l", xlab="Valores de variable",
     ylab = "Densidad", main="")
points(-2, hx[which(x == -2)], col = 'red', pch = 19, cex = 2) # Ver donde esta el z-stat estimado
```

--

Podemos usar la función:

```{r}
dnorm(x = -2, mean = 0, sd = 1)
```

---

# Distribución normal

Valor de variable dado una probabilidad acumulada:

```{r, echo = FALSE, out.width=300, fig.align="center"}
x = seq(-5, 5, by = 0.1)
hx = dnorm(x) 
plot(x, hx, type="l", xlab="Valores de variable",
     ylab = "Densidad", main="")
lb = -5 
ub = -2
i = x >= lb & x <= ub
lines(x, hx)
polygon(c(lb,x[i],ub), c(0,hx[i],0), col="gray80") 
points(-2, 0, col = 'red', pch = 19, cex = 2) # Ver donde esta el z-stat estimado
```

--

Podemos usar la función:

```{r}
qnorm(p = 0.0227, mean = 0, sd = 1)
```

---

# Distribución normal

Ejemplo 1:

¿Cúal es la probabilidad que la altura de un árbol sea menor a 90 m, dado que la media de la muestra es 100 y desviación estándar de 10?

--

```{r}
pnorm(q = 90, mean = 100, sd = 10)
```

--

Ejemplo 2:

¿Cúal es la probabilidad que la altura de un árbol sea mayor a 115 m, dado que la media de la muestra es 100 y desviación estándar de 10?

--

```{r}
1 - pnorm(q = 115, mean = 100, sd = 10)
```


---

# Distribución lognormal

Variable continua. Función de densidad:

$$f(x) = \frac{1}{{x\sigma \sqrt{2\pi}}} e^{{{ -(ln(x) - \mu)^2/2\sigma^2 }}}\hspace{1cm} x\in (0,+\infty)$$

donde $\mu$ (media) y $\sigma$ (desviación estándar) son los parámetros de la función. Representada como: $LnN(\mu, \sigma^2)$.

--

Media $E(X) = e^{\mu+\sigma^2/2}$

Varianza $Var(X) = e^{2\mu+\sigma^2}(e^{\sigma^2}-1)$


---

# Distribución lognormal

Podemos generar 1000 números aleatorios con distribución lognormal, con determinada media y desviación estándar:

```{r, eval = FALSE}
rlnorm(n = 1000, mean = 2, sd = 1)
```

```{r, echo = FALSE, out.width=400, fig.align="center"}
vec1 = rlnorm(n = 1000, mean = 2, sd = 1)
hist(vec1, ylab = 'Frecuencia', main = '', xlab = '')
```

---

# Distribución lognormal

Similar al caso de la distribución normal, podemos calcular:

--

Probabilidad acumulada:

```{r}
plnorm(q = 20, mean = 2, sd = 1)
```

--

Probabilidad a un valor de variable dado:

```{r}
dlnorm(x = 20, mean = 2, sd = 1)
```

--

Valor de variable dado una probabilidad acumulada:

```{r}
qlnorm(p = 0.84, mean = 2, sd = 1)
```

---

# Distribución poisson

Variable discreta. Función de densidad:

$$P(X=x) = \frac{{e^{ - \lambda } \lambda ^x }}{{x!}}\hspace{1cm}x=0,1,2,...$$

donde $\lambda$ es el parámetro principal y es mayor a cero. Representada como: $Poi(\lambda)$.

--

Media $E(X) = \lambda$

Varianza $Var(X) = \lambda$


---

# Distribución poisson

Podemos generar 100 números aleatorios con distribución poisson, con determinada parámetro $\lambda$:

```{r, eval = FALSE}
rpois(n = 100, lambda = 10)
```

```{r, echo = FALSE, out.width=400, fig.align="center"}
vec1 = rpois(n = 100, lambda = 10)
hist(vec1, ylab = 'Frecuencia', main = '', xlab = '')
```


---

# Distribución poisson

Similar al caso de la distribución normal, podemos calcular:

--

Probabilidad acumulada:

```{r}
ppois(q = 8, lambda = 10)
```

--

Probabilidad a un valor de variable dado:

```{r}
dpois(x = 8, lambda = 10)
```

--

Valor de variable dado una probabilidad acumulada:

```{r}
qpois(p = 0.33, lambda = 10)
```


---

# Distribución binomial

Variable discreta. Función de probabilidad:

$$P(X=x) = \binom{n}{x}p^x(1-p)^{n-x}\hspace{1cm}x=0,1,2,...,n$$

donde $n$ representa el número de intentos y $p$ es la probabilidad de ocurrencia de un evento de interés. Representada como: $Bin(n,p)$.

--

Media $E(X) = np$

Varianza $Var(X) = np(1-p)$


---

# Distribución binomial

Podemos generar 100 experimentos (`n=100`), cada uno con 20 intentos (`size=20`), donde cada intento tiene probabilidad de éxito $p=0.5$ para un evento de interés:

```{r, eval = FALSE}
rbinom(n = 100, size = 20, prob = 0.5)
```

```{r, echo = FALSE, out.width=400, fig.align="center"}
vec1 = rbinom(n = 100, size = 20, prob = 0.5)
hist(vec1, ylab = 'Frecuencia', main = '', xlab = '')
```

El número de veces donde el evento de interés ha sido exitoso para los 100 experimentos

---

# Distribución binomial

Similar al caso de la distribución normal, podemos calcular:

--

Probabilidad acumulada:

```{r}
pbinom(q = 10, size = 20, prob = 0.5)
```

--

Probabilidad a un valor de variable dado:

```{r}
dbinom(x = 10, size = 20, prob = 0.5)
```

--

Valor de variable dado una probabilidad acumulada:

```{r}
qbinom(p = 0.588, size = 20, prob = 0.5)
```

---

# Distribución binomial

Ejemplo 1:

Se sabe que la proporción de hembras en una muestra es de 0.6. En una muestra se tienen 80 individuos. ¿Cuál es la probabilidad de encontrar menos de 40 hembras? 

--

```{r}
pbinom(q = 40, size = 80, prob = 0.6)
```


---

class: inverse, center, middle

# Gracias!

Contacto: [**cursos@cousteau-group.com**](mailto:cursos@cousteau-group.com)

```{r echo = FALSE, out.width=450, fig.align="center"}
knitr::include_graphics("LOGO05.png")
```
